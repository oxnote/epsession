# Double End Point Detected Session Manager

## End Point Session이란?
서버가 최종 단말을 기준으로 세션을 관리하는 방법을 말합니다.
네트워크에서 종말(Terminal) 또는 단말(End Node)이란 라우터에 전달되기 위해 외부에서 보여지는 IP와 Port 조합을 의미합니다.
어떤 이유에서건 EndPoint(이하 EP)가 변경되면 해당 네트워크 세션이 종료된 것으로 간주해야하지만 브라우저 환경과 네트워크 환경의 변화로 이러한 방식에 불편함 점이 많아 쿠키라는 이상한(?) 방법을 통해 세션을 유지하고 있습니다.

## EP 세션 개념
EP 세션은 서버에서 제공하는 토큰과 클라이언트가 제공하는 토큰으로 구성됩니다.
이 토큰을 각각 token, token2로 부르도록 하겠습니다.
먼저 클라이언트가 서버에 접속하여 인증(로그인)을 시도합니다. 이때 아이디와 암호를 보내는데 이 아이디와 암호는 중간에 가로채어 노출되지 않도록 보안 통신 및 기타 방법으로 전달되는 됩니다.

서버는 클라이언트가 접속하면 클라이언트 인증 정보를 바탕으로 1차 토큰을 발행하여 클라이언트에 전달합니다.
클라이언트는 특별한 경우(클라이언트 자체 브라우저 EP 변경 또는 제3자 개입으로 인한 중간자 가로채기)가 아니면 1차 토큰을 이용해 세션을 유지합니다.

서버가 발행한 토큰을 제시하였지만 발행시 접속한 EP가 아닌 경우 서버는 2차 인증을 요구합니다. 즉, EP를 변경해도 되는지 확인하는 과정입니다.

이때, 클라이언트는 로그인할때 사용되었던 정보(로그인한 컴퓨터와 서버만 알고 있는 정보)를 중간에 해독할 수 없는 단방향 해시(MD5 등) 방법을 이용하여 서버에 추가로 전달합니다. 만일 이 과정에 중간자가 개입되었다면 이 정보를 보낼 수 없게됩니다.

서버는 1차 토큰과 2차 토큰이 모두 정확한 경우에만 EP 변경을 허용하고 세션을 지속합니다.

이것이 EP 세션 보안의 개녑입니다.
